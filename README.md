# DeVAIC

Please run on a Linux OS. 

The tool was run on an environment having Ubuntu 22.04.3 LTS with Python 3.10.12


## Description

**DeVAIC** (**De**tection of **V**ulnerabilities  in **AI**-generated **C**ode) is a tool that works on code snippets written in Python language with the aim of detecting vulnerabilities belonging to 9 of the OWASP categories listed in the Top 10 of 2021 (i.e., **Broken Access Control**, **Cryptographic Failures**, **Identification and Authentication Failures**, **Injection**, **Insecure Design**, **Security Logging and Monitoring Failures**, **Security Misconfiguration**, **SSRF**, **Software and Data Integrity Failures**).


## Step 1: Make the file executable

Make the file executable with the following commands:
```bash
chmod +x devaic.sh

chmod +x tool_derem.sh
```



## Step 2: Setup

### For Linux OS (Ubuntu/Debian):

If you are using Linux OS, please install **jq** using the following commands:
```bash
sudo apt-get update

sudo apt-get install jq
```

After this installation, you can jump to the Step 3.

### For MacOS:

For MacOS system, install **jq** using **Homebrew**; if Homebrew is not installed, follow the next step **Install Homebrew**, otherwise go directly to **Install jq**.


### (1) Install Homebrew

Use the provided command to download and install the script:
```bash
wget https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh
```


Now navigate to the directory where it got downloaded and run the following command to allow it to be executable by your user account:
```bash
chmod u+x install.sh
```


Run the install script with Bourne Again Shell:
```bash
./install.sh
```


Then, close the terminal and start it again. 


### (2) Install jq

Once Homebrew is installed on your system, you can install **jq** with the following command:
```bash
brew install jq
```


### (3) Use the GNU-like version of grep

In the case of MacOS, type the following command from the shell to ensure compatibility with the grep command:
```bash
brew install grep
```


## Step 3: Run the experiments:

### Input file

Move the file to analyze (INPUT_FILE) into the directory ``DeVAIC/input``.

You can use INPUT_FILE in ``.txt`` format. For instance, the input folder contains four files in txt format each having the code snippets generated by four different models, i.e., Copilot (``c_copilot.txt``), Bard (``c_bard.txt``), Bing AI (``c_bing_ai.txt``) and ChatGPT (``c_chatgpt.txt``).


### Running DeVAIC 

To launch the detection tool & remediation tool, move into the main folder and run the following command:
``./devaic.sh input/[INPUT_FILE]``

At the end of the execution, three files will be generated: 

1. ``DeVAIC/results/detection/DET_[timestamp]_[INPUT_FILE].txt``, containing the results of detection. For each snippet there is a label indicating whether it is vulnerable or not:

* ``[!] VULN CODE``, if the code is **vulnerable**. In this case, the type of OWASP vulnerability detected is reported;

* ``==> SAFE CODE``, if the code is **safe**.

2. ``DeVAIC/results/remediation/REM_[timestamp]_[INPUT_FILE].txt``, containing the results of remediation. For each snippet, there are these labels:

* ``==> MODIFIED``, if the vulnerable code is **remediated**;

* ``==> NOT MOD`` , if the vulnerable code is **not remediated**;

* ``==> SAFE CODE``, if the code is **safe**.

3. ``DeVAIC/results/changes/CNG_[timestamp]_[INPUT_FILE].txt``, containing the comparison between the detected vulnerable snippets and the related safe versions. Near to the vulnerable code snippet detected, there is another code snippet that can be:

* ``==> SAFE CODE``, the remedieted version;

* ``==> NOT_SAFE``, the same vulnerable snippet detected, that is not remediated.




### Interpreting Results

At the end of its execution, in addition to the creation of the **DET**, **REM** and **CNG** files indicated above, DeVAIC displays the following information in the Command Prompt from which it was launched:

* **\#DimTestSet**: Total number of evaluated snippets;

* **\#TotalVulnerabilities**: Number of vulnerable snippets detected;

* **\#SafeCode**: Number of snippets marked as safe;

* **Vulnerability Rate**: Rate of detected vulnerabilities (i.e. number of vulnerable snippets out of total snippets);

* **List of OWASP categories**: Number of vulnerable snippets belonging to each OWASP category;

* **Runtime**: Overall execution time on the entire dataset of snippets;

* **Average runtime per snippet**: Average execution time per single snippet.



#### Example 

1. To detect the vulnerabilities among the snippets listed in ``c_copilot.txt`` located in the ``input`` folder, move into the main folder and use the following command:
``./devaic.sh input/c_copilot.txt``

2. Then, move to the path ``DeVAIC/results/detection`` to analyze the results of the detection shown in the file ``DET_[timestamp]_c_copilot.txt``.

3. Move to the path ``DeVAIC/results/remediation`` to analyze the results of the remediation shown in the file ``REM_[timestamp]_c_copilot.txt``.

4. Finally, move to the path ``DeVAIC/results/changes`` to see the comaprison between the vulnerable code snippets and their remediated version shown in the file ``CNG_[timestamp]_c_copilot.txt``.